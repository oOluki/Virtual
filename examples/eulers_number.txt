;; RA will store the number e
;; RB will store n (number of current iterations)
;; RC will store the total number of iterations to be performed
;; RD holds 1.0f
;; RE holds 1 / n!


MOVV RA 1     
MOVV RB 0     
MOVV RC 10 

; casting everything to double
CASTFU RA RA
CASTFU RB RB
CASTFU RC RC
MOV RD RA
MOV RE RA

loop:
    ADDF RB RD RB
    DIVF RE RE RB
    ADDF RA RE RA
    MOV  RF RB
    SMLF RF RF RC
JMPF RF $loop

;; display the result
DISREG RA

;; writting e by piecewise reconstruction
MOVV16 RB6 0x4005
MOVV16 RB4 0xbf0a
MOVV16 RB2 0x8b14
MOVV16 RB  0x5769

;; getting the absolute value of the difference between the expected and actual value
SUBF RA RA RB
MOVV RB 0
;; NOTE: this may not work depending on the endianess of the platform
MOVV16 RB7 128
XOR RA RA RB

;; getting the precision
MOVV RC 1
MOVV RD 1000
CASTFU RC RC
CASTFU RD RD
DIVF RC RC RD
SMLF RC RC RA

HALT RC
